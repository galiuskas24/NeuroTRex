import pickle

from agent import Agent
from game import *


if __name__ == '__main__':

    with open('best_genome.pickle', 'rb') as f:
        best_genome = pickle.load(f)

    generation = 0
    max_score = None

    while True:
        generation += 1
        agent = Agent(best_genome)

        game = Game(
            dinos=[TRex()],
            agents=[agent],
            learning_mode=False,
            generation=generation
        )
        while game.iter(): pass

        if max_score is None or agent.score > max_score:
            max_score = agent.score

        print(f'Generation: {generation}, score: {agent.score}, max score: {max_score}')
